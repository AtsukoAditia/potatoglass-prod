(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-51511d31"],{"0442":function(t,a,e){"use strict";e.r(a);var r=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("b-container",{attrs:{fluid:""}},[e("b-row",[e("b-col",{attrs:{md:"12",sm:"12"}},[e("iq-card",{scopedSlots:t._u([{key:"body",fn:function(){return[e("b-row",[e("b-col",{attrs:{md:"12"}},[t.showResolution?e("router-link",{attrs:{to:t.idnya+"/resolusi"}},[1==t.roleid?e("b-button",{staticClass:"float-right",attrs:{variant:"info"}},[t._v("Resolusi")]):t._e()],1):t._e()],1)],1),e("b-row",[e("b-col",{attrs:{md:"6"}},[e("div",{staticClass:"table-responsive"},[e("table",{staticClass:"table table-borderless table-sm"},[e("tr",[e("td",[t._v("Order ID")]),e("td",[t._v(": #"+t._s(t.detail.order_id))])]),e("tr",[e("td",[t._v("Status Transaksi")]),e("td",[t._v(": "),1==t.detail.status?e("b-badge",{attrs:{variant:"warning"}},[t._v("Pesanan Masuk")]):t._e(),2==t.detail.status?e("b-badge",{attrs:{variant:"primary"}},[t._v("DP Telah Diterima")]):t._e(),3==t.detail.status?e("b-badge",{attrs:{variant:"primary"}},[t._v("Pesanan diterima Vendor")]):t._e(),4==t.detail.status?e("b-badge",{attrs:{variant:"warning"}},[t._v("Pesanan dalam Pengiriman")]):t._e(),9==t.detail.status?e("b-badge",{attrs:{variant:"info"}},[t._v("Pesanan Diterima")]):t._e(),10==t.detail.status?e("b-badge",{attrs:{variant:"success"}},[t._v("Pesanan Berhasil")]):t._e(),11==t.detail.status?e("b-badge",{attrs:{variant:"danger"}},[t._v("Pesanan Ditolak Vendor")]):t._e(),12==t.detail.status?e("b-badge",{attrs:{variant:"danger"}},[t._v("Pesanan Dibatalkan User")]):t._e(),t.showTermin?e("div",{staticClass:"d-inline ml-2"},[e("b-button",{attrs:{variant:"warning",size:"sm",id:"show-btn"},on:{click:t.showModalTermin}},[t._v("Lihat Termin ")])],1):t._e()],1)])])])]),e("b-col",{attrs:{md:"6"}},[e("div",{staticClass:"table-responsive"},[e("table",{staticClass:"table table-borderless table-sm"},[e("tr",[e("td",[t._v("Total Jumlah Barang")]),e("td",[t._v(": "+t._s(t.separatorNum(t.detail.jumlah_item)))])]),e("tr",[e("td",[t._v("Total Transaksi")]),e("td",[t._v(": "),0!=t.detail.dp_amount?e("span",[e("span",{staticClass:"font-weight-bold"},[t._v("Rp "+t._s(t.separatorNum(parseFloat(t.detail.total_transaction-t.detail.dp_amount)))+" ")]),e("small",[e("s",[t._v("Rp "+t._s(t.separatorNum(t.detail.total_transaction)))])])]):e("span",[t._v(" Rp "+t._s(t.separatorNum(t.detail.total_transaction))+" ")])])])])])])],1),e("b-row",{staticClass:"justify-content-md-center"},[e("b-col",{attrs:{md:"12"}},[e("b-table",{ref:"dTable",attrs:{items:t.getDetail,fields:t.fields,"current-page":t.currentPage,"per-page":t.perPage},on:{filtered:t.onFiltered},scopedSlots:t._u([{key:"cell(no)",fn:function(a){return[e("span",{attrs:{"v-for":a}},[t._v(" "+t._s((t.currentPage-1)*t.perPage+(a.index+1))+" ")])]}},{key:"cell(delivery_time)",fn:function(a){return[e("div",[(a.item.type_delivery=1)?e("b-badge",{attrs:{variant:"info"}},[t._v("Ekspedisi")]):t._e(),(a.item.type_delivery=0)?e("b-badge",{attrs:{variant:"info"}},[t._v("Kirim Sendiri")]):t._e()],1),e("div",[t._v(t._s(t._f("moment")(a.item.delivery_time)))]),0!=a.item.cost_delivery?e("div",[t._v("Rp "+t._s(t.separatorNum(a.item.cost_delivery)))]):e("div")]}},{key:"cell(fee)",fn:function(a){return["0"!=a.item.discount?e("span",[t._v(" Rp "+t._s(t.separatorNum(a.item.sub_total/100*2))+" ")]):e("span",[t._v(" 0 ")])]}},{key:"cell(sub_total)",fn:function(a){return[e("div",{staticClass:"d-block"},[t._v("Rp "+t._s(t.separatorNum(a.item.sub_total)))]),0!=a.item.discount?e("b-badge",{attrs:{variant:"success"}},[t._v("Discount "),e("b",[t._v(t._s(a.item.discount)+"%")])]):e("div")]}},{key:"cell(price)",fn:function(a){return[t._v(" Rp "+t._s(t.separatorNum(a.item.price))+" ")]}},{key:"cell(material_name)",fn:function(a){return[e("router-link",{attrs:{to:"/material/"+a.item.m_id}},[t._v(" "+t._s(a.item.material_name)+" ")])]}},{key:"cell(qty)",fn:function(a){return[t._v(" "+t._s(t.separatorNum(a.item.qty))+" ")]}}])},[e("template",{slot:"bottom-row"},[e("td",{attrs:{colspan:"4"}}),e("td",[e("div",[e("b",[t._v("Pembelian")])]),e("div",[e("b",[t._v("Pengiriman")])]),e("div",[e("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"font-weight-bold",attrs:{title:"Fee admin dikenakan untuk pemotongan dana"}},[t._v("Fee 2% "),e("i",{staticClass:"fas fa-info-circle"})])]),e("div",[e("b",[t._v("Total Pembayaran")])])]),e("td",[e("div",[e("b",[t._v("Rp "+t._s(t.separatorNum(t.detail.total_transaction)))])]),e("div",[e("b",[t._v("Rp "+t._s(t.separatorNum(t.detail.total_delivery)))])]),e("div",[e("b",[t._v("Rp "+t._s(t.separatorNum(Math.round(t.detail.total_transaction/100*2))))])]),e("div",[e("b",[t._v("Rp "+t._s(t.separatorNum(t.detail.total_payment)))])])])])],2)],1)],1),e("b-row",[e("b-col",{staticClass:"my-1",attrs:{md:"6"}},[e("b-pagination",{staticClass:"my-0",attrs:{"total-rows":t.totalRows,"per-page":t.perPage,align:"fill",size:"sm"},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1),1==t.roleid?e("b-col",{staticClass:"text-right",attrs:{md:"6"}},[2==t.detail.status?e("div",[e("b-button",{staticClass:"mr-2 w-25",attrs:{variant:"danger"},on:{click:function(a){return t.postLog(11)}}},[t._v("Tolak")]),e("b-button",{staticClass:"mr-2 w-25",attrs:{variant:"success"},on:{click:function(a){return t.postLog(3)}}},[t._v("Terima Pesanan")])],1):1==t.detail.status?e("div",[e("b-button",{staticClass:"mr-2 w-25",attrs:{variant:"danger"},on:{click:function(a){return t.postLog(11)}}},[t._v("Tolak")])],1):3==t.detail.status?e("div",[e("b-button",{staticClass:"mr-2 w-50",attrs:{variant:"success"},on:{click:t.orderToDeliv}},[t._v("Atur Pengiriman")])],1):4==t.detail.status?e("div",[e("b-button",{staticClass:"mr-2 w-50",attrs:{variant:"success"},on:{click:function(a){return t.postLog(9)}}},[t._v("Pesanan Telah Diterima")])],1):e("div")]):t._e()],1)]},proxy:!0}])})],1)],1),e("b-modal",{ref:"modalTermin",attrs:{centered:"",title:"Pengajuan Termin dari Kontraktor"},scopedSlots:t._u([1==t.terminData.status_approval?{key:"modal-footer",fn:function(){return[e("div",{staticClass:"w-100"},[e("b-button",{staticClass:"float-right mr-2",attrs:{variant:"success",size:"sm"},on:{click:function(a){return t.accTermin(1)}}},[t._v(" Terima Pengajuan ")]),e("b-button",{staticClass:"float-right mr-2",attrs:{variant:"danger",size:"sm"},on:{click:function(a){return t.accTermin(2)}}},[t._v(" Tolak ")])],1)]},proxy:!0}:null],null,!0)},[e("div",{staticClass:"table-responsive"},[e("table",{staticClass:"table table-borderless table-sm"},[e("tr",[e("th",[t._v("Order ID")]),e("td",[t._v(": #"+t._s(t.terminData.order_id))])]),e("tr",[e("th",[t._v("Tgl. Pengajuan")]),e("td",[t._v(": "+t._s(t._f("moment")(t.terminData.created_at)))])]),e("tr",[e("th",[t._v("Status")]),e("td",[t._v(": "),0==t.terminData.status_approval?e("b-badge",{attrs:{variant:"warning"}},[t._v("Sedang Pengajuan")]):t._e(),1==t.terminData.status_approval?e("b-badge",{attrs:{variant:"primary"}},[t._v("Diterima Vendor")]):t._e(),2==t.terminData.status_approval?e("b-badge",{attrs:{variant:"danger"}},[t._v("Ditolak")]):t._e()],1),e("th",[t._v("Jumlah Termin")]),e("td",[t._v(": "+t._s(t.terminData.jumlah_termin))])])]),e("br"),e("table",{staticClass:"table table-striped table-sm"},[e("thead",[e("tr",[e("th",[t._v("Termin")]),e("th",[t._v("Nilai")]),e("th",[t._v("%")]),e("th",[t._v("Jth. Tempo")]),e("th",[t._v("Status")])])]),e("tbody",t._l(t.terminData.detail,(function(a,r){return e("tr",{key:r},[e("td",[t._v(t._s(a.termin_ke))]),e("td",[t._v("Rp "+t._s(t.separatorNum(a.nilai_bayar)))]),e("td",[t._v(t._s(a.persentase)+"%")]),e("td",[t._v(t._s(a.jatuh_tempo))]),e("td",[null==a.status_bayar?e("b-badge",{attrs:{variant:"danger"}},[t._v("Belum Bayar")]):t._e(),1==a.status_bayar?e("b-badge",{attrs:{variant:"success"}},[t._v("Lunas")]):t._e()],1)])})),0)])])])],1)},s=[],i=e("5530"),n=(e("d81d"),e("4de4"),e("d3b7"),e("99af"),e("ac1f"),e("5319"),e("25f0"),e("bcae")),o=e("b46c"),l=e("c1df"),d=e.n(l),u=e("bc3a"),c=e.n(u),m=e("2f62"),_=e("358c"),v={name:"BookingDetail",props:{},mounted:function(){n["d"].index(),this.getTermin()},data:function(){return{fields:[{key:"no",label:"No.",sortable:!0},{key:"material_name",label:"Material"},{key:"delivery_time",label:"Pengiriman",sortable:!0,sortDirection:"asc"},{key:"qty",label:"Jumlah"},{key:"price",label:"Harga"},{key:"sub_total",label:"Sub Total"}],detail:{kode_proyek:"",order_id:"",customer_name:"",buyer_name:"",buyer_phone:"",customer_address:"",jumlah_item:"",total_transaction:"",status:"",dp_percent:"",dp_amount:"",total_delivery:"",total_payment:""},totalRows:"",currentPage:1,perPage:10,pageOptions:[5,10,15],sortBy:"",sortDesc:!1,sortDirection:"asc",filter:null,filterOn:[],filterDeliv:"",showTermin:!1,showResolution:!1,terminData:[],roleid:this.dataUser().user.role,idnya:this.$route.params.id}},filters:{moment:function(t){return d()(t).format("D MMMM YYYY")}},computed:{sortOptions:function(){return this.fields.filter((function(t){return t.sortable})).map((function(t){return{text:t.label,value:t.key}}))}},methods:Object(i["a"])(Object(i["a"])({},Object(m["c"])({dataUser:"authModule/getUserData"})),{},{getDetail:function(t){var a,e=this,r=0,s=0;return o["a"].order.getDetailPHP(this.$route.params.id).then((function(t){var i=t.data;if(t.status){for(e.detail.order_id=i.result.order.order_id,e.detail.status=i.result.order.status,a=0;a<i.result.items.length;a++)r+=parseInt(i.result.items[a].qty),s+=parseInt(i.result.items[a].cost_delivery);e.detail.jumlah_item=r,e.detail.total_transaction=i.result.order.total_price,e.detail.total_delivery=s,e.detail.total_payment=i.result.order.total_price+s+Math.round(i.result.order.total_price/100*2),e.totalRows=20;var n=i.result.items;return n||[]}t.data.errors.length>0&&e.$refs.dTable.setErrors(t.data.errors)})).finally((function(){e.loading=!1}))},getTermin:function(){var t=this;c.a.get("".concat(_["a"].urlAPIPHP,"/get_termin/").concat(this.$route.params.id),{headers:{}}).then((function(a){var e=a.data;a.status&&(e.success?(t.showTermin=!0,t.terminData=e.row[0],e.row.status_resolusi>0?t.showResolution=!0:t.showResolution=!1):(t.showTermin=!1,t.showResolution=!1))})).finally((function(){t.loading=!1})).catch((function(){n["d"].showSnackbar("error","Maaf, terjadi kesalahan pada sistem.")}))},delivSuccess:function(){var t=this;o["a"].order.delivered(this.$route.params.id).then((function(a){a.status&&(n["d"].showSnackbar("success","Order berhasil diterima."),t.$router.push({name:"booking.all"}))})).finally((function(){t.loading=!1}))},onFiltered:function(t){this.totalRows=t.length,this.currentPage=1},rejectOrder:function(){var t=this;o["a"].order.reject(this.$route.params.id).then((function(a){a.status&&(n["d"].showSnackbar("success","Order telah ditolak."),t.$router.push({name:"booking.all"}))})).finally((function(){t.loading=!1}))},showModalTermin:function(){this.$refs["modalTermin"].show()},accTermin:function(t){var a,e=this,r=new FormData;r.append("id",this.$route.params.id),r.append("stats",t),a=1===t?confirm("Terima pengajuan termin ini?"):confirm("Tolak pengajuan termin ini?"),a&&c.a.post("".concat(_["a"].urlAPIPHP,"/status_termin"),r,{headers:{}}).then((function(t){t.status&&n["d"].showSnackbar("success","Berhasil update termin.")})).finally((function(){e.loading=!1})).catch((function(){n["d"].showSnackbar("error","Maaf, terjadi kesalahan pada sistem.")}))},postLog:function(t){var a,e,r=this,s=confirm("Proses pesanan dengan status yang di pilih?"),i=this.dataUser(),o=new Date,l=o.getFullYear()+"-"+(o.getMonth()+1)+"-"+o.getDate(),d=o.getHours()+":"+o.getMinutes()+":"+o.getSeconds(),u=l+" "+d;11===t?(a="Pesanan anda di tolak oleh Vendor",e="ri-close-line"):3===t?(a="Paket Anda Sedang Diproses",e="ri-check-line"):9===t&&(a="Pesanan sudah diterima",e="ri-check-line");var m=new FormData;m.append("id_user",i.user.id),m.append("order_id",this.$route.params.id),m.append("log_activity",a),m.append("icon_status",e),m.append("created_date",u),s&&c.a.post("".concat(_["a"].urlAPIPHP,"/save_log"),m,{headers:{}}).then((function(a){a.status&&(n["d"].showSnackbar("error","Update log berhasil..."),11===t?r.rejectOrder():3===t?r.accOrder():9===t&&r.delivSuccess())})).finally((function(){r.loading=!1})).catch((function(){n["d"].showSnackbar("error","Maaf, terjadi kesalahan pada sistem.")}))},accOrder:function(){var t=this;o["a"].order.accept(this.$route.params.id).then((function(a){a.status&&(n["d"].showSnackbar("success","Silahkan melakukan setting pengiriman."),t.$refs.dTable.refresh(),t.$router.push({name:"booking.delivery",id:t.$route.params.id}))})).finally((function(){t.loading=!1}))},orderToDeliv:function(){this.$router.push({name:"booking.delivery",id:this.$route.params.id})},separatorNum:function(t){return"undefined"===typeof t||null===t||"null"===t?null:(t=parseFloat(t),t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,"."))}})},b=v,p=(e("9778"),e("2877")),f=Object(p["a"])(b,r,s,!1,null,null,null);a["default"]=f.exports},"35b5":function(t,a,e){},9778:function(t,a,e){"use strict";e("35b5")}}]);
//# sourceMappingURL=chunk-51511d31.be3d8d06.js.map